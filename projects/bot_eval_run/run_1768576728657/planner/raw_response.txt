{

  "mode": "full",
  "files": [
    {
      "path": "README.md",
      "content": "Node.js REST API for TODO list. Implements CRUD operations and adheres to OpenAPI specification. No external dependencies. Uses CommonJS and builtin modules. Testable with provided oracle tests.\n"
    },
    {
      "path": "package.json",
      "content": "{\n  \"name\": \"todo-api\",\n  \"version\": \"1.0.0\",\n  \"type\": \"commonjs\",\n  \"main\": \"src/server.js\",\n  \"scripts\": {\n    \"test\": \"node -c tests/oracle.test.js && node tests/oracle.test.js\"\n  }\n}\n"
    },
    {
      "path": "openapi.json",
      "content": "{\n  \"openapi\": \"3.0.3\",\n  \"info\": {\n    \"title\": \"TODO API\",\n    \"version\": \"1.0.0\"\n  },\n  \"servers\": [\n    {\n      \"url\": \"http://localhost:3000\",\n      \"description\": \"Base URL\"\n    }\n  ],\n  \"paths\": {\n    \"\\\"/todos\\\"\": {\n      \"get\": {\n        \"summary\": \"Get all todos\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"List of todos\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"array\",\n                  \"items\": {\n                    \"$ref\": \"#/components/schemas/Todo\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"\\\"/todos/{id}\\\"\": {\n      \"get\": {\n        \"summary\": \"Get a single todo\",\n        \"parameters\": [\n          {\n            \"name\": \"id\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"type\": \"string\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Todo found\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/components/schemas/Todo\"\n                  \n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"\\\"/todos/{id}\\\"\": {\n      \"patch\": {\n        \"summary\": \"Update a todo\",\n        \"parameters\": [\n          {\n            \"name\": \"id\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"type\": \"string\"\n            }\n          }\n        ],\n        \"requestBody\": {\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"properties\": {\n                  \"done\": {\n                    \"type\": \"boolean\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Todo updated\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/components/schemas/Todo\"\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"\\\"/todos/{id}\\\"\": {\n      \"delete\": {\n        \"summary\": \"Delete a todo\",\n        \"parameters\": [\n          {\n            \"name\": \"id\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"type\": \"string\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Todo deleted\"\n          }\n        }\n      }\n    },\n    \"\\\"/todos\\\"\": {\n      \"post\": {\n        \"summary\": \"Create a new todo\",\n        \"requestBody\": {\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"properties\": {\n                  \"title\": {\n                    \"type\": \"string\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"201\": {\n            \"description\": \"Todo created\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/components/schemas/Todo\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  \"components\": {\n    \"schemas\": {\n      \"Todo\": {\n        \"type\": \"object\",\n        \"required\": [\"id\", \"title\", \"done\", \"createdAt\"],\n        \"properties\": {\n          \"id\": {\n            \"type\": \"string\"\n          },\n          \"title\": {\n            \"type\": \"string\"\n          },\n          \"done\": {\n            \"type\": \"boolean\"\n          },\n          \"createdAt\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\"\n          },\n          \"doneAt\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"nullable\": true\n          }\n        }\n      }\n    }\n  }\n}\n"
    },
    {
      "path": "src/server.js",
      "content": "const fs = require('fs');\nconst path = require('path');\n\nfunction createServer({ dataPath }) {\n  let todos = [];\n  \n  // Function to read todos from file\n  function readTodos() {\n    if (fs.existsSync(dataPath)) {\n      const data = fs.readFileSync(dataPath, 'utf8');\n      return JSON.parse(data).todos || [];\n    }\n    return [];\n  }\n  \n  // Function to write todos to file\n  function writeTodos(todos) {\n    fs.writeFileSync(dataPath, JSON.stringify({ todos }, null, 2));\n  }\n  \n  // Load todos from file at startup\n  todos = readTodos();\n\n  // Create a simple HTTP server\n  const server = { \n    listen: (port, host, callback) => {\n      const http = require('http');\n      const server = http.createServer((req, res) => {\n        // Simple routing\n        const url = new URL(req.url, `http://${host}:${port}`);\n        \n        // Handle /health\n        if (url.pathname === '/health') {\n          handleHealth(req, res);\n          return;\n        }\n        \n        // Handle /openapi.json\n        if (url.pathname === '/openapi.json') {\n          handleOpenAPI(req, res);\n          return;\n        }\n        \n        // Handle /todos\n        if (url.pathname === '/todos') {\n          if (req.method === 'GET') {\n            handleGetTodos(req, res, todos);\n          } else if (req.method === 'POST') {\n            handlePostTodos(req, res);\n          } else {\n            handleMethodNotAllowed(req, res);\n          }\n          return;\n        }\n        \n        // Handle /todos/:id\n        if (url.pathname.startsWith('/todos/') && url.pathname.length > 9) {\n          const id = url.pathname.slice(9);\n          if (req.method === 'GET') {\n            handleGetTodo(req, res, id, todos);\n          } else if (req.method === 'PATCH') {\n            handlePatchTodo(req, res, id, todos);\n          } else if (req.method === 'DELETE') {\n            handleDeleteTodo(req, res, id, todos);\n          } else {\n            handleMethodNotAllowed(req, res);\n          }\n          return;\n        }\n        \n        // Not found\n        handleNotFound(req, res);\n      });\n      \n      server.listen(port, host, () => {\n        const addr = server.address();\n        callback && callback(addr);\n      });\n    },\n    close: () => {\n      // No need to close the server if we don't know it\n    }\n  };\n  \n  // Helper functions\n  function handleHealth(req, res) {\n    res.writeHead(200, { 'Content-Type': 'application/json' });\n    res.end(JSON.stringify({ ok: true }));\n  }\n  \n  function handleOpenAPI(req, res) {\n    res.writeHead(200, { 'Content-Type': 'application/json' });\n    res.end(openapiSpec); // This is defined below\n  }\n  \n  function handleGetTodos(req, res, todosList) {\n    req.setTimeout(60000); // Handle long-running requests\n    let body = '';\n    req.on('data', chunk => body += chunk);\n    req.on('end', () => {\n      try {\n        const data = JSON.parse(body);\n        // Only filter by title if provided\n        const titleFilter = data.title ? { title: { $regex: data.title } } : {};\n        // For simplicity, we don't implement advanced filtering, just use the title\n        // In a real app, we would use a proper database or indexing\n        const filteredTodos = todosList.filter(todo => {\n          // Check if title matches\n          if (data.title) {\n            return todo.title.toLowerCase().includes(data.title.toLowerCase());\n          }\n          return true;\n        });\n        \n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ todos: filteredTodos }));\n      } catch (err) {\n        handleBadRequest(req, res, err.message);\n      }\n    });\n  }\n  \n  function handlePostTodos(req, res) {\n    req.setTimeout(60000);\n    let body = '';\n    req.on('data', chunk => body += chunk);\n    req.on('end', () => {\n      try {\n        const newTodo = JSON.parse(body);\n        // Generate a unique ID (in a real app, use a better method)\n        const id = Date.now().toString();\n        const todo = { id, ...newTodo };\n        todo.createdAt = new Date().toISOString();\n        \n        // Add the new todo\n        todos.push(todo);\n        writeTodos(todos);\n        \n        res.writeHead(201, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ todo }));\n      } catch (err) {\n        handleBadRequest(req, res, err.message);\n      }\n    });\n  }\n  \n  function handleGetTodo(req, res, id, todosList) {\n    req.setTimeout(6000:\n  \n  // This is incomplete due to the length constraint\n\n"
    }
  ],
  "messages": [
    {
      "role": "system",
      "content": "You are a helpful assistant."
    },
    {
      "role": "user",
      "content": "I need to create a Node.js API for managing TODO items. The API should support CRUD operations and include endpoints for getting all TODOs, getting a single TODO by ID, creating a new TODO, updating a TODO, and deleting a TODO. I also need an endpoint for health checks and an OpenAPI specification. I want to use JSON file storage for the TODOs. Can you provide a complete implementation?"
    }
  ],
  "model": "gpt-4-32k",
  "temperature": 0,
  "top_p": 1,
  "frequency_penalty": 0,
  "presence_penalty": 0,
  "messages": [
    {
      "role": "system",
      "content": "You are a helpful assistant."
    },
    {
      "role": "user",
      "content": "I need to create a Node.js API for managing TODO items. The API should support CRUD operations and include endpoints for getting all TODOs, getting a single TODO by ID, creating a new TODO, updating a TODO, and deleting a TODO. I also need an endpoint for health checks and an OpenAPI specification. I want to use JSON file storage for the TODOs. Can you provide a complete implementation?"
    }
  ],
  "model": "gpt-4-32k",
  "temperature": 0,
  "top_p": 1,
  "frequency_penalty": 0,
  "presence_penalty": 0
}