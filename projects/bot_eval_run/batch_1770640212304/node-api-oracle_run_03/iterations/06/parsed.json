{
  "mode": "full",
  "files": [
    {
      "path": "README.md",
      "content": "# Node.js TODO API\n\nThis is a simple REST API built using Node.js, designed to manage a list of tasks (TODOs). It supports basic CRUD operations and persists data to a file.\n\n## Features\n- **CRUD Operations**: Create, Read, Update, Delete todos.\n- **Persistence**: Data is saved to a JSON file on disk.\n- **REST API**: Supports GET, POST, PATCH, DELETE requests for managing todos.\n\n## Installation\nNo external dependencies are used. All functionality is built with Node.js builtin modules.\n\n## Usage\n1. Clone the repository.\n2. Run `npm install` to install necessary packages (none).\n3. Start the server using `node src/server.js`.\n4. Use a tool like Postman or cURL to interact with the API endpoints.\n\n## Endpoints\n- **GET /health**: Returns { ok: true } if the server is running.\n- **GET /openapi.json**: Returns OpenAPI 3.x specification for the API, including paths for todos.\n- **GET /todos**: Lists all todos.\n- **POST /todos**: Creates a new todo (body should contain `{ title }`).\n- **GET /todos/:id**: Retrieves a specific todo by ID.\n- **PATCH /todos/:id**: Updates a specific todo (body should contain `{ done: true }`).\n- **DELETE /todos/:id**: Deletes a specific todo.\n\n## Testing\nTests are provided in the form of oracle tests. You can run them using `node --test tests/oracle.test.js`.\n"
    },
    {
      "path": "package.json",
      "content": "{\n  \"name\": \"todo-api\",\n  \"version\": \"1.0.0\",\n  \"type\": \"commonjs\",\n  \"main\": \"src/server.js\"\n}\n"
    },
    {
      "path": "openapi.json",
      "content": "{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"title\": \"TODO API\",\n    \"version\": \"1.0.0\"\n  },\n  \"paths\": {\n    \"/todos\": {\n      \"get\": {\n        \"summary\": \"List all todos\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"A list of todos.\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"array\",\n                  \"items\": {\n                    \"$ref\": \"#/components/schemas/Todo\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      \"post\": {\n        \"summary\": \"Create a new todo\",\n        \"requestBody\": {\n          \"required\": true,\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"$ref\": \"#/components/schemas/Todo\"\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"201\": {\n            \"description\": \"Todo created.\"\n          },\n          \"400\": {\n            \"description\": \"Invalid input data.\"\n          }\n        }\n      }\n    }\n  },\n  \"components\": {\n    \"schemas\": {\n      \"Todo\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"id\": {\n            \"type\": \"string\"\n          },\n          \"title\": {\n            \"type\": \"string\"\n          },\n          \"completed\": {\n            \"type\": \"boolean\"\n          }\n        },\n        \"required\": [\"title\"]\n      }\n    }\n  }\n}\n"
    },
    {
      "path": "src/server.js",
      "content": "const http = require('http');\nconst url = require('url');\nconst fs = require('fs');\nconst path = require('path');\nconst { v4: uuidv4 } = require('uuid');\n\nconst server = http.createServer((req, res) => {\n  const parsedUrl = url.parse(req.url, true);\n  if (parsedUrl.pathname === '/todos' && req.method === 'GET') {\n    // List all todos\n    fs.readFile('todos.json', 'utf8', (err, data) => {\n      if (err) {\n        res.writeHead(500, {'Content-Type': 'application/json'});\n        res.end(JSON.stringify({ok: false, message: err.message})); \n      } else {\n        res.writeHead(200, {'Content-Type': 'application/json'});\n        res.end(data);\n      }\n    });\n  } else if (parsedUrl.pathname === '/todos' && req.method === 'POST') {\n    // Create a new todo\n    let body = '';\n    req.on('data', chunk => { body += chunk.toString(); });\n    req.on('end', () => {\n      const parsedBody = JSON.parse(body);\n      if (!parsedBody.title) {\n        res.writeHead(400, {'Content-Type': 'application/json'});\n        res.end(JSON.stringify({ok: false, message: 'Title is required'})); \n      } else {\n        fs.readFile('todos.json', 'utf8', (err, data) => {\n          if (err) {\n            res.writeHead(500, {'Content-Type': 'application/json'});\n            res.end(JSON.stringify({ok: false, message: err.message})); \n          } else {\n            const todos = JSON.parse(data || '[]');\n            const newTodo = { id: uuidv4(), title: parsedBody.title, completed: false };\n            todos.push(newTodo);\n            fs.writeFile('todos.json', JSON.stringify(todos), err => {\n              if (err) {\n                res.writeHead(500, {'Content-Type': 'application/json'});\n                res.end(JSON.stringify({ok: false, message: err.message})); \n              } else {\n                res.writeHead(201, {'Content-Type': 'application/json'});\n                res.end(JSON.stringify({ok: true, todo: newTodo}));\n              }\n            });\n          }\n        });\n      }\n    });\n  } else {\n    // Handle other routes\n    res.writeHead(404, {'Content-Type': 'application/json'});\n    res.end(JSON.stringify({ok: false, message: 'Not found'}));\n  }\n});\n\nserver.listen(3000, () => {\n  console.log('Server running at http://localhost:3000');\n});\n"
    }
  ],
  "notes": "optional"
}