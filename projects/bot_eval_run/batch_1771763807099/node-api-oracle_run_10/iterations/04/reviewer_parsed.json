{
  "output": "{ \"output\": \"--- FILE: src/server.js ---\n// Import necessary modules\nconst http = require('http');\nconst fs = require('fs');\nconst path = require('path');\nconst crypto = require('crypto');\n\n// Function to generate a unique ID\nfunction generateUniqueId() {\n  return crypto.randomBytes(16).toString('hex');\n}\n\n// Function to read the todos file\nfunction readTodosFile(filePath) {\n  try {\n    const data = fs.readFileSync(filePath, 'utf8');\n    return JSON.parse(data);\n  } catch (error) {\n    if (error.code === 'ENOENT') {\n      return [];\n    }\n    throw error;\n  }\n}\n\n// Function to write the todos file\nfunction writeTodosFile(filePath, data) {\n  fs.writeFileSync(filePath, JSON.stringify(data, null, 2), 'utf8');\n}\n\n// Create server\nconst server = http.createServer((req, res) => {\n  const filePath = path.join(__dirname, 'todos.json');\n  let todos = readTodosFile(filePath);\n\n  // Handle GET /health\n  if (req.method === 'GET' && req.url === '/health') {\n    res.writeHead(200, { 'Content-Type': 'application/json' });\n    res.end(JSON.stringify({ ok: true }));\n    return;\n  }\n\n  // Handle GET /todos\n  if (req.method === 'GET' && req.url === '/todos') {\n    res.writeHead(200, { 'Content-Type': 'application/json' });\n    res.end(JSON.stringify({ ok: true, todos }));\n    return;\n  }\n\n  // Handle POST /todos\n  if (req.method === 'POST' && req.url === '/todos') {\n    let body = '';\n    req.on('data', chunk => {\n      body += chunk.toString();\n    });\n    req.on('end', () => {\n      const newTodo = JSON.parse(body);\n      newTodo.id = generateUniqueId();\n      newTodo.createdAt = new Date().toISOString();\n      todos.push(newTodo);\n      writeTodosFile(filePath, todos);\n      res.writeHead(201, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true, todo: newTodo }));\n    });\n    return;\n  }\n\n  // Handle GET /todos/:id\n  const id = req.url.match(/^/todos/(.*)$/);\n  if (req.method === 'GET' && id) {\n    const todo = todos.find(t => t.id === id[1]);\n    if (todo) {\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true, todo }));\n    } else {\n      res.writeHead(404, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: false, error: 'Not Found' }));\n    }\n    return;\n  }\n\n  // Handle PATCH /todos/:id\n  if (req.method === 'PATCH' && id) {\n    let body = '';\n    req.on('data', chunk => {\n      body += chunk.toString();\n    });\n    req.on('end', () => {\n      const update = JSON.parse(body);\n      const todoIndex = todos.findIndex(t => t.id === id[1]);\n      if (todoIndex !== -1) {\n        todos[todoIndex] = { ...todos[todoIndex], ...update };\n        if (update.done && !todos[todoIndex].doneAt) {\n          todos[todoIndex].doneAt = new Date().toISOString();\n        }\n        writeTodosFile(filePath, todos);\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ ok: true, todo: todos[todoIndex] }));\n      } else {\n        res.writeHead(404, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ ok: false, error: 'Not Found' }));\n      }\n    });\n    return;\n  }\n\n  // Handle DELETE /todos/:id\n  if (req.method === 'DELETE' && id) {\n    const todoIndex = todos.findIndex(t => t.id === id[1]);\n    if (todoIndex !== -1) {\n      todos.splice(todoIndex, 1);\n      writeTodosFile(filePath, todos);\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true }));\n    } else {\n      res.writeHead(404, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: false, error: 'Not Found' }));\n    }\n    return;\n  }\n\n  // Handle all other requests\n  res.writeHead(404, { 'Content-Type': 'text/plain' });\n  res.end('Not Found');\n});\n\n// Start server\nconst PORT = process.env.PORT || 3000;\nserv...\" }"
}