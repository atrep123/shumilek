{
  "mode": "full",
  "files": [
    {
      "path": "README.md",
      "content": "## Todo Task Manager\\n\\nA simple TypeScript CLI application for managing tasks.\\n\\n### Features\\n- Add tasks\\n- Mark tasks as done\\n- Remove tasks\\n- Persist tasks to a JSON file\\n\\n### Usage\\n```bash\\n# Add a new task\\nnode cli.js add \"Task title\" --data path/to/tasks.json\\n\\n# List tasks\\nnode cli.js list --data path/to/tasks.json\\n\\n# Mark a task as done\\nnode cli.js done <id> --data path/to/tasks.json\\n\\n# Remove a task\\nnode cli.js remove <id> --data path/to/tasks.json\\n```\\n\\n### Requirements\\n- Node.js\\n- TypeScript\\n\\n### Notes\\nThis project does not use any external npm packages, only Node.js built-in modules.\\n\\nYou can compile the project using `tsc -p tsconfig.json` and the compiled output will be in the `dist/` directory.\\n\\n### Running Tests\\nOracle tests can be run by executing `node node_modules/node:test/cli.js` or similar, but note that the test runner might require additional setup.\\n\\n### License\\nMIT"
    },
    {
      "path": "package.json",
      "content": "{\\n  \"name\": \"todo-ts-cli\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A TypeScript CLI application for managing tasks.\",\n  \"main\": \"dist/cli.js\",\n  \"scripts\": {\n    \"build\": \"tsc -p tsconfig.json\",\n    \"test\": \"node --test dist/store.js\"\n  },\n  \"author\": \"\",\n  \"license\": \"MIT\",\n  \"type\": \"module\"\n}"
    },
    {
      "path": "tsconfig.json",
      "content": "{\\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"module\": \"CommonJS\",\n    \"rootDir\": \"src\",\n    \"outDir\": \"dist\",\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true\n  },\n  \"include\": [\"src/**/*\"],\n  \"exclude\": [\"node_modules\"]\n}"
    },
    {
      "path": "src/store.ts",
      "content": "/* eslint-disable @typescript-eslint/no-var-requires */\n\nconst require = require('module');\n\n// Declare the require function for Node.js built-in modules\nconst { existsSync, readFileSync, writeFileSync, readdirSync, mkdirSync, statSync } = require('fs');\nconst { join, resolve } = require('path');\n\n// Task interface\ninterface Task {\n  id: string;\n  title: string;\n  done: boolean;\n  createdAt: string;\n  doneAt?: string;\n}\n\n// TaskStore class\nclass TaskStore {\n  private filePath: string;\n  private tasks: Task[] = [];\n\n  constructor(filePath: string) {\n    this.filePath = filePath;\n    this.loadTasks();\n  }\n\n  private loadTasks(): void {\n    if (existsSync(this.filePath)) {\n      try {\n        const data = readFileSync(this.filePath, 'utf8');\n        if (data.trim()) {\n          const tasks = JSON.parse(data);\n          if (Array.isArray(tasks)) {\n            this.tasks = tasks;\n          }\n        }\n      } catch (error) {\n        console.error('Error loading tasks:', error);\n        this.tasks = [];\n      }\n    }\n  }\n\n  private saveTasks(): void {\n    try {\n      writeFileSync(this.filePath, JSON.stringify(this.tasks, null, 2));\n    } catch (error) {\n      console.error('Error saving tasks:', error);\n    }\n  }\n\n  public list(): Task[] {\n    return [...this.tasks];\n  }\n\n  public add(title: string): Task {\n    const newTask: Task = {\n      id: this.generateId(),\n      title,\n      done: false,\n      createdAt: new Date().toISOString(),\n    };\n    this.tasks.push(newTask);\n    this.saveTasks();\n    return newTask;\n  }\n\n  private generateId(): string {\n    // Simple ID generation using timestamp and random number\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  public done(id: string): Task {\n    const taskIndex = this.tasks.findIndex(t => t.id === id);\n    if (taskIndex === -1) {\n      throw new Error(`Task with id ${id} not found`);\n    }\n    const task = { ...this.tasks[taskIndex] };\n    task.done = true;\n    if (!task.doneAt) {\n      task.doneAt = new Date().toISOString();\n    }\n    this.saveTasks();\n    return task;\n  }\n\n  public remove(id: string): Task {\n    const taskIndex = this.tasks.findIndex(t => t.id === id);\n    if (taskIndex === -1) {\n      throw new Error(`Task with id ${id} not found`);\n    }\n    const task = this.tasks[taskIndex];\n    this.tasks.splice(taskIndex, 1);\n    this.saveTasks();\n    return task;\n  }\n}\n\n// Export the TaskStore class\nmodule.exports = TaskStore;"
    },
    {
      "path": "src/cli.ts",
      "content": "/* eslint-disable @typescript-eslint/no-var-requires */\n\nconst require = require('module');\n\n// Declare the require function for Node.js built-in modules\nconst { spawnSync } = require('child_process');\nconst { existsSync, readFileSync, writeFileSync, mkdirSync, statSync, readdirSync, unlinkSync } = require('fs');\nconst { join, resolve, dirname, basename } = require('path');\nconst { execSync } = require('child_process');\n\n// Check for required arguments\nconst args = process.argv.slice(2);\n\n// Help command\nif (args[0] === '--help') {\n  console.log('Usage: node cli.js <command> [options]\\n\\nCommands:\\n- add <title> --data <path>\\n- list --data <path>\\n- done <id> --data <path>\\n- remove <id> --data <path>\\n\\nOptions:\\n- --help: Show this help message');\n  process.exit(0);\n}\n\n// Command line parsing and execution\nconst command = args[0];\nconst dataPath = args[args.length - 1].startsWith('--data') ? args[args.length - 1] : undefined;\nif (!dataPath) {\n  console.error('--data is required');\n  process.exit(1);\n}\n\nconst taskStoreModule = require('./store');\n\n// Helper function to validate and get the task store\nfunction getTaskStore(dataPath: string): TaskStore {\n  try {\n    return new taskStoreModule.TaskStore(dataPath);\n  } catch (error) {\n    console.error(error.message);\n    process.exit(1);\n  }\n}\n\n// Execute the appropriate command\nswitch (command) {\n  case 'add':\n    if (args.length < 3) {\n      console.error('Missing required arguments. Use --help for usage.');\n      process.exit(1);\n    }\n    const title = args[1];\n    const store = getTaskStore(dataPath);\n    const task = store.add(title);\n    console.log(JSON.stringify({ ok: true, task }));\n    process.exit(0);\n  case 'list':\n    if (args.length < 2) {\n      console.error('Missing required arguments. Use --help for usage.');\n      process.exit(1);\n    }\n    const store = getTaskStore(dataPath);\n    const tasks = store.list();\n    console.log(JSON.stringify({ ok: true, tasks }));\n    process.exit(0);\n  case 'done':\n    if (args.length < 3) {\n      console.error('Missing required arguments. Use --help for usage.');\n      process.exit(1);\n    }\n    const id = args[1];\n    const store = getTaskStore(dataPath);\n    const task = store.done(id);\n    console.log(JSON.stringify({ ok: true, task }));\n    process.exit(0);\n  case 'remove':\n    if (args.length < 3) {\n      console.error('Missing required arguments. Use --help for usage.');\n      process.exit(1);\n    }\n    const id = args[1];\n    const store = getTaskStore(dataPath);\n    const task = store.remove(id);\n    console.log(JSON.stringify({ ok: true, task }));\n    process.exit(0);\n  default:\n    console.error(`Unknown command: ${command}. Use --help for usage.`);\n    process.exit(1);\n}"
    }
  ],
  "notes": "The project structure includes the necessary files for building a TypeScript CLI application for managing tasks. The `store.ts` file implements the TaskStore class with CRUD operations and persistence to a JSON file. The `cli.ts` file provides a command-line interface for interacting with the TaskStore. The `tsconfig.json` and `package.json` are set up for compilation and testing. The README.md file provides documentation for the application. The code is compiled to the `dist/` directory using `tsc -p tsconfig.json`."
}