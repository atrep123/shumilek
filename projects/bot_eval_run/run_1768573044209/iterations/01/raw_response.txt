{
  "mode": "full",
  "files": [
    {
      "path": "README.md",
      "content": "# Simple TODO API\nThis project provides a REST API for managing TODO items using Node.js built-in modules.\n"
    },
    {
      "path": "package.json",
      "content": "{\n  \"name\": \"todo-api\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Simple TODO API\",\n  \"main\": \"src/server.js\",\n  \"type\": \"commonjs\",\n  \"scripts\": {\n    \"start\": \"node src/server.js\"\n  },\n  \"author\": \"Your Name\",\n  \"license\": \"MIT\"\n}\n"
    },
    {
      "path": "openapi.json",
      "content": "{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"title\": \"TODO API\",\n    \"version\": \"1.0.0\"\n  },\n  \"paths\": {\n    \"/health\": {\n      \"get\": {\n        \"summary\": \"Health check endpoint\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"OK\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"ok\": {\n                      \"type\": \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/openapi.json\": {\n      \"get\": {\n        \"summary\": \"OpenAPI Specification\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"OK\",\n            \"content\": {\n              \"application/json\": {}\n            }\n          }\n        }\n      }\n    },\n    \"/todos\": {\n      \"get\": {\n        \"summary\": \"List all TODOs\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"OK\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"ok\": {\n                      \"type\": \"boolean\"\n                    },\n                    \"todos\": {\n                      \"type\": \"array\",\n                      \"items\": {}\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      \"post\": {\n        \"summary\": \"Create a new TODO\",\n        \"requestBody\": {\n          \"required\": true,\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"type\": \"object\",\n                \"properties\": {\n                  \"title\": {\n                    \"type\": \"string\"\n                  }\n                },\n                \"required\": [\"title\"]\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"201\": {\n            \"description\": \"Created\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"ok\": {\n                      \"type\": \"boolean\"\n                    },\n                    \"todo\": {}\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/todos/{id}\": {\n      \"parameters\": [\n        {\n          \"name\": \"id\",\n          \"in\": \"path\",\n          \"required\": true,\n          \"schema\": {\n            \"type\": \"string\"\n          }\n        }\n      ],\n      \"get\": {\n        \"summary\": \"Get a TODO by ID\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"OK\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"ok\": {\n                      \"type\": \"boolean\"\n                    },\n                    \"todo\": {}\n                  }\n                }\n              }\n            }\n          },\n          \"404\": {\n            \"description\": \"Not Found\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"ok\": {\n                      \"type\": \"boolean\"\n                    },\n                    \"error\": {\n                      \"type\": \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      \"patch\": {\n        \"summary\": \"Update a TODO by ID\",\n        \"requestBody\": {\n          \"required\": true,\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"type\": \"object\",\n                \"properties\": {\n                  \"done\": {\n                    \"type\": \"boolean\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"200\": {\n            \"description\": \"OK\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"ok\": {\n                      \"type\": \"boolean\"\n                    },\n                    \"todo\": {}\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      \"delete\": {\n        \"summary\": \"Delete a TODO by ID\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"OK\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"ok\": {\n                      \"type\": \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n"
    },
    {
      "path": "src/server.js",
      "content": "\"use strict\";\n\nconst http = require('http');\nconst fs = require('fs');\nconst path = require('path');\nconst url = require('url');\nconst crypto = require('crypto');\n\nfunction loadData(dataPath) {\n  if (fs.existsSync(dataPath)) {\n    const data = fs.readFileSync(dataPath, 'utf8');\n    return JSON.parse(data);\n  }\n  return { todos: [] };\n}\n\nfunction saveData(dataPath, data) {\n  fs.writeFileSync(dataPath, JSON.stringify(data), 'utf8');\n}\n\nfunction createServer({ dataPath }) {\n  const db = loadData(dataPath);\n\n  function findTodo(id) {\n    return db.todos.find(todo => todo.id === id);\n  }\n\n  function removeTodo(id) {\n    const index = db.todos.findIndex(todo => todo.id === id);\n    if (index !== -1) {\n      db.todos.splice(index, 1);\n      saveData(dataPath, db);\n      return true;\n    }\n    return false;\n  }\n\n  function updateTodo(id, changes) {\n    const todo = findTodo(id);\n    if (todo) {\n      Object.assign(todo, changes);\n      saveData(dataPath, db);\n      return todo;\n    }\n    return null;\n  }\n\n  const server = http.createServer((req, res) => {\n    const parsedUrl = url.parse(req.url, true);\n    const method = req.method.toUpperCase();\n    const pathname = parsedUrl.pathname;\n    let id = pathname.split('/')[2];\n\n    if (pathname === '/health' && method === 'GET') {\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true }));\n      return;\n    }\n\n    if (pathname === '/openapi.json' && method === 'GET') {\n      const openApiSpec = fs.readFileSync(path.join(__dirname, '../../openapi.json'), 'utf8');\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(openApiSpec);\n      return;\n    }\n\n    if (pathname === '/todos' && method === 'GET') {\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true, todos: db.todos }));\n      return;\n    }\n\n    if (pathname === '/todos' && method === 'POST') {\n      let body = '';\n      req.on('data', chunk => {\n        body += chunk.toString();\n      });\n      req.on('end', () => {\n        try {\n          const { title } = JSON.parse(body);\n          if (!title) {\n            res.writeHead(400, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: false, error: 'Title is required' }));\n            return;\n          }\n          const newTodo = {\n            id: crypto.randomUUID(),\n            title,\n            done: false,\n            createdAt: new Date().toISOString()\n          };\n          db.todos.push(newTodo);\n          saveData(dataPath, db);\n          res.writeHead(201, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true, todo: newTodo }));\n        } catch (e) {\n          res.writeHead(400, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: false, error: 'Invalid JSON body' }));\n        }\n      });\n      return;\n    }\n\n    if (pathname.startsWith('/todos/') && method === 'GET') {\n      const todo = findTodo(id);\n      if (!todo) {\n        res.writeHead(404, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ ok: false, error: 'TODO not found' }));\n        return;\n      }\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true, todo }));\n      return;\n    }\n\n    if (pathname.startsWith('/todos/') && method === 'PATCH') {\n      let body = '';\n      req.on('data', chunk => {\n        body += chunk.toString();\n      });\n      req.on('end', () => {\n        try {\n          const changes = JSON.parse(body);\n          if (!changes.done) {\n            res.writeHead(400, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: false, error: 'Done status is required' }));\n            return;\n          }\n          const todo = updateTodo(id, changes);\n          if (!todo) {\n            res.writeHead(404, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: false, error: 'TODO not found' }));\n            return;\n          }\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true, todo }));\n        } catch (e) {\n          res.writeHead(400, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: false, error: 'Invalid JSON body' }));\n        }\n      });\n      return;\n    }\n\n    if (pathname.startsWith('/todos/') && method === 'DELETE') {\n      const removed = removeTodo(id);\n      if (!removed) {\n        res.writeHead(404, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ ok: false, error: 'TODO not found' }));\n        return;\n      }\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true }));\n      return;\n    }\n\n    res.writeHead(404, { 'Content-Type': 'application/json' });\n    res.end(JSON.stringify({ ok: false, error: 'Not Found' }));\n  });\n\n  return server;\n}\n\nmodule.exports = createServer;\n"
    }
  ]
}