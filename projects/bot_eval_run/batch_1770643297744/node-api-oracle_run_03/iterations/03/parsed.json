{
  "mode": "full",
  "files": [
    {
      "path": "README.md",
      "content": "# Node.js TODO API Project\n\nThis project is a simple REST API for managing TODO items, built using only Node.js builtin modules.\n\n## Features\n- CRUD operations for TODOs\n- Persistence via JSON file\n- OpenAPI 3.0 compliant documentation\n\n## Installation\nClone the repository and run `npm install` to install dependencies.\n\n## Usage\nStart the server with `node src/server.js` and use the provided endpoints to manage TODOs.\n\n## Endpoints\n- GET /health: Returns a 200 status with JSON { ok: true }\n- GET /openapi.json: Returns OpenAPI 3.0 specification with paths for /todos\n- GET /todos: Lists all TODOs\n- POST /todos: Creates a new TODO item\n- GET /todos/:id: Retrieves a specific TODO by ID\n- PATCH /todos/:id: Updates the status of a TODO to done\n- DELETE /todos/:id: Deletes a specific TODO by ID\n"
    },
    {
      "path": "package.json",
      "content": "{ \"name\": \"todo-api\", \"version\": \"1.0.0\", \"type\": \"commonjs\" }\n"
    },
    {
      "path": "src/server.js",
      "content": "const http = require('node:http');\nconst url = require('node:url');\nconst crypto = require('node:crypto');\nconst fs = require('node:fs');\nconst path = require('node:path');\n\nmodule.exports.createServer = ({ dataPath }) => {\n  const todos = [];\n\n  return http.createServer((req, res) => {\n    const parsedUrl = url.parse(req.url, true);\n    if (parsedUrl.pathname === '/health') {\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true }));\n    } else if (parsedUrl.pathname === '/openapi.json') {\n      const openApiSpec = {\n        openapi: '3.0.0',\n        paths: { '/todos': {} }\n      };\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify(openApiSpec));\n    } else if (parsedUrl.pathname === '/todos') {\n      if (req.method === 'GET') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ ok: true, todos }));\n      } else if (req.method === 'POST') {\n        let body = '';\n        req.on('data', chunk => { body += chunk.toString(); });\n        req.on('end', () => {\n          const newTodo = JSON.parse(body);\n          newTodo.id = crypto.randomUUID();\n          newTodo.createdAt = new Date().toISOString();\n          todos.push(newTodo);\n          fs.writeFileSync(dataPath, JSON.stringify({ todos }));\n          res.writeHead(201, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true, todo: newTodo }));\n        });\n      }\n    } else if (parsedUrl.pathname.match(/^/todos/[a-f0-9]+$/)) {\n      const id = parsedUrl.pathname.split('/')[2];\n      if (req.method === 'GET') {\n        const todo = todos.find(t => t.id === id);\n        if (todo) {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true, todo }));\n        } else {\n          res.writeHead(404, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: false, error: 'Todo not found' }));\n        }\n      } else if (req.method === 'PATCH') {\n        let body = '';\n        req.on('data', chunk => { body += chunk.toString(); });\n        req.on('end', () => {\n          const updates = JSON.parse(body);\n          const index = todos.findIndex(t => t.id === id);\n          if (index !== -1) {\n            todos[index].done = true;\n            todos[index].doneAt = new Date().toISOString();\n            fs.writeFileSync(dataPath, JSON.stringify({ todos }));\n            res.writeHead(200, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: true, todo: todos[index] }));\n          } else {\n            res.writeHead(404, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: false, error: 'Todo not found' }));\n          }\n        });\n      } else if (req.method === 'DELETE') {\n        const index = todos.findIndex(t => t.id === id);\n        if (index !== -1) {\n          todos.splice(index, 1);\n          fs.writeFileSync(dataPath, JSON.stringify({ todos }));\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true }));\n        } else {\n          res.writeHead(404, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: false, error: 'Todo not found' }));\n        }\n      }\n    } else {\n      res.writeHead(404, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: false, error: 'Endpoint not found' }));\n    }\n  }).listen(8080);\n};\n"
    }
  ],
  "notes": "optional"
}