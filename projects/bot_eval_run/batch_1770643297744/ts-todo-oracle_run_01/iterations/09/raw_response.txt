{ "mode": "patch", "files": [ {"path":"src/cli.ts","content":"import { TaskStore } from './store';\nimport process from 'node:process';\nimport fs from 'node:fs';\nconst argv = process.argv.slice(2);\nlet cmd = argv[0];\nif (cmd === '--help') {\n  console.log('Usage: todo <command> [options]');\n  console.log('Commands:\n  add <title> --data <path>    Add a new task\n  list --data <path>        List all tasks\n  done <id> --data <path>    Mark a task as done\n  remove <id> --data <path>  Remove a task');\n  process.exit(0);\n}\ncmd = cmd.replace(/^-+/, '');\nconst dataPath = argv.find(arg => arg.startsWith('--data')).split('=')[1];\nconst args = argv.filter(arg => !arg.startsWith('--data'));\n\nswitch (cmd) {\ncase 'add':\n  const title = args[0].replace(/^['\"](.*?)['\"]$/, '$1');\n  const store = new TaskStore(dataPath);\n  const task = store.add(title);\n  console.log({ ok: true, task });\n  break;\ncase 'list':\n  const storeList = new TaskStore(dataPath);\n  const tasks = storeList.list();\n  console.log({ ok: true, tasks });\n  break;\ncase 'done':\n  const id = args[0];\n  const storeDone = new TaskStore(dataPath);\n  const task = storeDone.done(id);\n  if (task) {\n    console.log({ ok: true, task });\n  } else {\n    console.log({ ok: false, message: 'Task not found' });\n  }\n  break;\ncase 'remove':\n  const id = args[0];\n  const storeRemove = new TaskStore(dataPath);\n  const task = storeRemove.remove(id);\n  if (task) {\n    console.log({ ok: true, task });\n  } else {\n    console.log({ ok: false, message: 'Task not found' });\n  }\n  break;\ndefault:\n  console.error('Unknown command:', cmd);\n  process.exit(1);\n}\n"} ]}