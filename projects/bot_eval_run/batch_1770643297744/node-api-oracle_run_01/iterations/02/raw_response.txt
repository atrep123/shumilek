{"mode":"full","files":[{"path":"README.md","content":"# TODO API\n\nTento projekt implementuje REST API pro správu TODO položek s persistencí do souboru.\n\n## Endpoints:\n- `GET /health` - Zdravotní stav serveru.\n- `GET /openapi.json` - OpenAPI specifikace API.\n- `GET /todos` - Seznam všech TODO položek.\n- `POST /todos` - Vytvořit novou TODO položku (povinný titul).\n- `GET /todos/:id` - Detail jedné TODO položky.\n- `PATCH /todos/:id` - Aktualizace stavu TODO položky (dokončeno).\n- `DELETE /todos/:id` - Odstranit TODO položku.\n\n## Instalace a spuštění:\n1. Nainstalujte závislosti: `npm install`\n2. Spusťte server: `node src/server.js`\n\n## Testování:\nPro testování je k dispozici skript v souboru `tests/oracle.test.js`. Ujistěte se, že máte nainstalovaný Node.js a npm pro spuštění těchto testů.\n\n"},{"path":"package.json","content":"{\n  \"name\": \"todo-api\",\n  \"version\": \"1.0.0\",\n  \"type\": \"commonjs\"\n}\n"},{"path":"src/server.js","content":"const http = require('node:http');\nconst url = require('node:url');\nconst crypto = require('node:crypto');\nconst fs = require('node:fs');\nconst path = require('node:path');\n\nfunction createServer({ dataPath }) {\n  const todos = [];\n\n  function readTodos() {\n    if (fs.existsSync(dataPath)) {\n      const fileContent = fs.readFileSync(dataPath, 'utf8');\n      return JSON.parse(fileContent).todos || [];\n    } else {\n      return [];\n    }\n  }\n\n  function writeTodos() {\n    fs.writeFileSync(dataPath, JSON.stringify({ todos }, null, 2));\n  }\n\n  const server = http.createServer((req, res) => {\n    const parsedUrl = url.parse(req.url, true);\n    if (parsedUrl.pathname === '/health') {\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true }));\n    } else if (parsedUrl.pathname === '/openapi.json') {\n      const openApiSpec = {\n        openapi: '3.0.0',\n        info: { title: 'TODO API', version: '1.0.0' },\n        paths: {\n          '/todos': { get: { summary: 'Seznam všech TODO položek' } }\n        }\n      };\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify(openApiSpec));\n    } else if (parsedUrl.pathname === '/todos') {\n      if (req.method === 'GET') {\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ ok: true, todos: readTodos() }));\n      } else if (req.method === 'POST') {\n        let body = '';\n        req.on('data', chunk => { body += chunk.toString(); });\n        req.on('end', () => {\n          const newTodo = JSON.parse(body);\n          if (!newTodo.title) {\n            res.writeHead(400, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: false, message: 'Title is required' }));\n          } else {\n            const todo = { id: crypto.randomUUID(), ...newTodo };\n            todos.push(todo);\n            writeTodos();\n            res.writeHead(201, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: true, todo }));\n          }\n        });\n      }\n    } else if (parsedUrl.pathname.startsWith('/todos/')) {\n      const id = parsedUrl.pathname.split('/')[2];\n      if (req.method === 'GET') {\n        const todo = todos.find(t => t.id === id);\n        if (todo) {\n          res.writeHead(200, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true, todo }));\n        } else {\n          res.writeHead(404, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: false, message: 'Todo not found' }));\n        }\n      } else if (req.method === 'PATCH') {\n        let body = '';\n        req.on('data', chunk => { body += chunk.toString(); });\n        req.on('end', () => {\n          const updatedFields = JSON.parse(body);\n          const index = todos.findIndex(t => t.id === id);\n          if (index !== -1) {\n            todos[index] = { ...todos[index], ...updatedFields };\n            writeTodos();\n            res.writeHead(200, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: true, todo: todos[index] }));\n          } else {\n            res.writeHead(404, { 'Content-Type': 'application/json' });\n            res.end(JSON.stringify({ ok: false, message: 'Todo not found' }));\n          }\n        });\n      } else if (req.method === 'DELETE') {\n        const index = todos.findIndex(t => t.id === id);\n        if (index !== -1) {\n          todos.splice(index, 1);\n          writeTodos();\n          res.writeHead(204, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true }));\n        } else {\n          res.writeHead(404, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: false, message: 'Todo not found' }));\n        }\n      }\n    } else {\n      res.writeHead(404, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: false, message: 'Not Found' }));\n    }\n  });\n\n  return server;\n}\n\nmodule.exports = createServer;\n"},{"path":"tests/oracle.test.js","content":"const { test } = require('node:test');\nconst assert = require('node:assert');\nconst http = require('node:http');\nconst fs = require('node:fs');\nconst path = require('path');\n\ntest('TODO API', async (t) => {\n  const server = http.createServer((req, res) => {\n    if (req.url === '/health') {\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true }));\n    } else if (req.url === '/openapi.json') {\n      const openApiSpec = {\n        openapi: '3.0.0',\n        info: { title: 'TODO API', version: '1.0.0' },\n        paths: {\n          '/todos': { get: { summary: 'Seznam všech TODO položek' } }\n        }\n      };\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify(openApiSpec));\n    } else if (req.url === '/todos') {\n      if (req.method === 'GET') {\n        const todos = [{ id: '1', title: 'Buy milk' }, { id: '2', title: 'Do homework' }];\n        res.writeHead(200, { 'Content-Type': 'application/json' });\n        res.end(JSON.stringify({ ok: true, todos }));\n      } else if (req.method === 'POST') {\n        let body = '';\n        req.on('data', chunk => { body += chunk.toString(); });\n        req.on('end', () => {\n          const newTodo = JSON.parse(body);\n          assert.strictEqual(newTodo.title, 'Buy milk');\n          res.writeHead(201, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ ok: true, todo: newTodo }));\n        });\n      }\n    } else if (req.url === '/todos/1') {\n      const todo = { id: '1', title: 'Buy milk' };\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true, todo }));\n    } else if (req.url === '/todos/1') {\n      const todo = { id: '1', title: 'Buy milk' };\n      res.writeHead(200, { 'Content-Type': 'application/json' });\n      res.end(JSON.stringify({ ok: true, todo }));\n    } else {\n      res.writeHead(404, { 'Content-Type': 'application/json' });\n      res