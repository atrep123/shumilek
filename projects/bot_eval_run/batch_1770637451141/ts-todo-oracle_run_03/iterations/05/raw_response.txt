{
  "mode": "patch",
  "files": [
    {
      "path": "src/store.ts",
      "content": "// src/store.ts\n\ndeclare const require: any;\nconst fs = require('node:fs');\nconst crypto = require('node:crypto');\n\ntype Task = {\n  id: string,\n  title: string,\n  done: boolean,\n  createdAt: string,\n  doneAt?: string\n};\n\nclass TaskStore {\n  private filePath: string;\n\n  constructor(filePath: string) {\n    this.filePath = filePath;\n  }\n\n  list(): Task[] {\n    if (!fs.existsSync(this.filePath)) return [];\n    const data = fs.readFileSync(this.filePath, 'utf8');\n    return JSON.parse(data).tasks || [];\n  }\n\n  add(title: string): Task {\n    const task: Task = {\n      id: crypto.randomUUID(),\n      title,\n      done: false,\n      createdAt: new Date().toISOString()\n    };\n    let tasks = this.list();\n    tasks.push(task);\n    fs.writeFileSync(this.filePath, JSON.stringify({ tasks }, null, 2));\n    return task;\n  }\n\n  done(id: string): Task {\n    let tasks = this.list();\n    const taskIndex = tasks.findIndex(t => t.id === id);\n    if (taskIndex === -1) throw new Error('Task not found');\n    const task = tasks[taskIndex];\n    task.done = true;\n    task.doneAt = new Date().toISOString();\n    fs.writeFileSync(this.filePath, JSON.stringify({ tasks }, null, 2));\n    return task;\n  }\n\n  remove(id: string): Task {\n    let tasks = this.list();\n    const taskIndex = tasks.findIndex(t => t.id === id);\n    if (taskIndex === -1) throw new Error('Task not found');\n    const task = tasks[taskIndex];\n    tasks.splice(taskIndex, 1);\n    fs.writeFileSync(this.filePath, JSON.stringify({ tasks }, null, 2));\n    return task;\n  }\n}\n\nexport { TaskStore };\n"
    },
    {
      "path": "src/cli.ts",
      "content": "// src/cli.ts\n\ndeclare const require: any;\nconst fs = require('node:fs');\nconst process = require('process');\nconst { TaskStore } = require('./store.js');\n\nfunction help() {\n  console.log(`Usage:\n  list --data <path>\n  add <title> --data <path>\n  done <id> --data <path>\n  remove <id> --data <path>`);\n  process.exit(0);\n}\n\nif (process.argv.length < 3) {\n  help();\n}\n\nconst command = process.argv[2];\nconst args: { [key: string]: string } = {};\nfor (let i = 3; i < process.argv.length; i++) {\n  const arg = process.argv[i];\n  if (arg.startsWith('--')) {\n    const key = arg.slice(2);\n    const value = process.argv[++i];\n    args[key] = value;\n  }\n}\n\nif (!args.data) {\n  console.error('Missing --data argument');\n  process.exit(1);\n}\n\nconst store = new TaskStore(args.data);\n\nswitch (command) {\n  case 'list':\n    try {\n      const tasks = store.list();\n      console.log(JSON.stringify({ ok: true, tasks }, null, 2));\n    } catch (error) {\n      console.error(JSON.stringify({ ok: false, error: error.message }, null, 2));\n      process.exit(1);\n    }\n    break;\n\n  case 'add':\n    if (!args.title) {\n      console.error('Missing title argument');\n      process.exit(1);\n    }\n    try {\n      const task = store.add(args.title);\n      console.log(JSON.stringify({ ok: true, task }, null, 2));\n    } catch (error) {\n      console.error(JSON.stringify({ ok: false, error: error.message }, null, 2));\n      process.exit(1);\n    }\n    break;\n\n  case 'done':\n    if (!args.id) {\n      console.error('Missing id argument');\n      process.exit(1);\n    }\n    try {\n      const task = store.done(args.id);\n      console.log(JSON.stringify({ ok: true, task }, null, 2));\n    } catch (error) {\n      console.error(JSON.stringify({ ok: false, error: error.message }, null, 2));\n      process.exit(1);\n    }\n    break;\n\n  case 'remove':\n    if (!args.id) {\n      console.error('Missing id argument');\n      process.exit(1);\n    }\n    try {\n      const task = store.remove(args.id);\n      console.log(JSON.stringify({ ok: true, task }, null, 2));\n    } catch (error) {\n      console.error(JSON.stringify({ ok: false, error: error.message }, null, 2));\n      process.exit(1);\n    }\n    break;\n\n  case '--help':\n    help();\n    break;\n\n  default:\n    console.error(`Unknown command: ${command}`);\n    process.exit(1);\n}\n"
    }
  ],
  "notes": "Updated Task and TaskStore types, and updated CLI commands to use TaskStore methods."
}