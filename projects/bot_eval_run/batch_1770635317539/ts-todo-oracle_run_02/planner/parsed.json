{
  "mode": "full",
  "files": [
    {
      "path": "README.md",
      "content": "A simple TypeScript todo CLI application. Usage:\n\n  list --data <path>        List tasks\n  add <title> --data <path>  Add a task\n  done <id> --data <path>    Mark task as done\n  remove <id> --data <path>  Remove a task\n\nExample:\n  node dist/cli.js list --data tasks.json\n\nSee the oracle tests for more details."
    },
    {
      "path": "package.json",
      "content": "{\n  \"name\": \"todo-cli\",\n  \"version\": \"1.0.0\",\n  \"type\": \"module\",\n  \"main\": \"dist/cli.js\"\n}\n"
    },
    {
      "path": "tsconfig.json",
      "content": "{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"module\": \"CommonJS\",\n    \"rootDir\": \"src\",\n    \"outDir\": \"dist\",\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true\n  }\n}"
    },
    {
      "path": "src/store.ts",
      "content": "declare const require: any;\nconst fs = require('node:fs');\nconst path = require('node:path');\n\ninterface Task {\n  id: string;\n  title: string;\n  done: boolean;\n  createdAt: string;\n  doneAt?: string;\n}\n\nclass TaskStore {\n  private filePath: string;\n  private data: Task[];\n\n  constructor(filePath: string) {\n    this.filePath = filePath;\n    try {\n      const dataStr = fs.readFileSync(this.filePath, 'utf8');\n      if (dataStr) {\n        const parsed = JSON.parse(dataStr);\n        if (Array.isArray(parsed.tasks)) {\n          this.data = parsed.tasks;\n        } else {\n          throw new Error('Invalid data format');\n        }\n      } else {\n        this.data = [];\n      }\n    } catch (err) {\n      console.error(err);\n      this.data = [];\n    }\n  }\n\n  list(): Task[] {\n    return [...this.data];\n  }\n\n  add(title: string): Task {\n    const task: Task = {\n      id: crypto.randomUUID().toString(),\n      title,\n      done: false,\n      createdAt: new Date().toISOString(),\n    };\n    this.data.push(task);\n    this.save();\n    return task;\n  }\n\n  done(id: string): Task {\n    const task = this.data.find(t => t.id === id);\n    if (!task) throw new Error(`Task not found`);\n    task.done = true;\n    if (!task.doneAt) task.doneAt = new Date().toISOString();\n    this.save();\n    return task;\n  }\n\n  remove(id: string): Task {\n    const index = this.data.findIndex(t => t.id === id);\n    if (index === -1) throw new Error(`Task not found`);\n    const task = this.data.splice(index, 1)[0];\n    this.save();\n    return task;\n  }\n\n  private save() {\n    const data = { tasks: this.data };\n    fs.writeFileSync(this.filePath, JSON.stringify(data, null, 2), 'utf8');\n  }\n}\n\n// Export the TaskStore class\nexport default TaskStore;"
    },
    {
      "path": "src/cli.ts",
      "content": "declare const require: any;\nconst fs = require('node:fs');\nconst path = require('node:path');\nconst process = require('node:process');\n\nconst { spawn } = require('node:child_process');\n\n// Import the TaskStore class\nconst TaskStore = require('./store.js').default;\n\nfunction main() {\n  // Parse command line arguments\n  const args = process.argv.slice(2);\n  \n  // Check for help flag\n  if (args.includes('--help')) {\n    console.log(`Usage: ${process.execPath} ${path.basename(__dirname + '/cli.js')} [command] [options]`);\n    console.log('\\nAvailable commands:');\n    console.log('  list    - List tasks');\n    console.log('  add     - Add a task');\n    console.log('  done    - Mark task as done');\n    console.log('  remove  - Remove a task');\n    console.log('\\nOptions:');\n    console.log('  --data <path>  Path to the tasks data file');\n    process.exit(0);\n  }\n\n  // Check if required arguments are present\n  if (args.length < 1) {\n    console.error('Error: Missing command. Use --help for usage.');\n    process.exit(1);\n  }\n\n  const command = args[0];\n  const dataPath = args.find(arg => arg.startsWith('--data='))?.substring(7) || '';\n  \n  if (!dataPath) {\n    console.error('Error: --data option is required. Use --help for usage.');\n    process.exit(1);\n  }\n\n  // Handle different commands\n  switch (command) {\n    case 'list':\n      listTasks(dataPath);\n      break;\n    case 'add':\n      if (args.length < 2) {\n        console.error('Error: Missing task title. Use --help for usage.');\n        process.exit(1);\n      }\n      addTask(args[1], dataPath);\n      break;\n    case 'done':\n      if (args.length < 2) {\n        console.error('Error: Missing task id. Use --help for usage.');\n        process.exit(1);\n      }\n      markTaskDone(args[1], dataPath);\n      break;\n    case 'remove':\n      if (args.length < 2) {\n        console.error('Error: Missing task id. Use --help for usage.');\n        process.exit(1);\n      }\n      removeTask(args[1], dataPath);\n      break;\n    default:\n      console.error(`Error: Unknown command \"${command}\". Use --help for usage.`);\n      process.exit(1);\n  }\n}\n\nfunction listTasks(dataPath: string) {\n  try {\n    const store = new TaskStore(dataPath);\n    const tasks = store.list();\n    console.log(JSON.stringify({ ok: true, tasks }, null, 2));\n  } catch (error) {\n    console.error(JSON.stringify({ ok: false, error: error.message }));\n    process.exit(1);\n  }\n}\n\nfunction addTask(title: string, dataPath: string) {\n  try {\n    const store = new TaskStore(dataPath);\n    const task = store.add(title);\n    console.log(JSON.stringify({ ok: true, task }, null, 2));\n  } catch (error) {\n    console.error(JSON.stringify({ ok: false, error: error.message }));\n    process.exit(1);\n  }\n}\n\nfunction markTaskDone(id: string, dataPath: require('./store.js').default) {\n  try {\n    const store = new TaskStore(dataPath);\n    const task = store.done(id);\n    console.log(JSON.stringify({ ok: true, task }, null, 2));\n  } catch (error) {\n    console.error(JSON.stringify({ ok: false, error: error.message }));\n    process.exit(1);\n  }\n}\n\nfunction removeTask(id: string, dataPath: string) {\n  try {\n    const store = new TaskStore(dataPath);\n    const task = store.remove(id);\n    console.log(JSON.stringify({ ok: true, task }, null, 2));\n  } catch (error) {\n    console.error(JSON.stringify({ ok: false, error: error.message }));\n    process.exit(1);\n  }\n}\n\n// Start the CLI\nif (require.main === module) {\n  main();\n}"
    }
  ],
  "notes": "The plan includes creating the necessary files for the TypeScript CLI application. The code uses Node.js built-in modules and avoids external dependencies. The oracle tests provided are not included in the output, as per the instructions. The build process uses TypeScript compiler to compile to CommonJS format in the 'dist' directory. The README.md provides usage instructions. The tests are not included in the output, but the oracle tests are provided separately and can be used for validation."
}